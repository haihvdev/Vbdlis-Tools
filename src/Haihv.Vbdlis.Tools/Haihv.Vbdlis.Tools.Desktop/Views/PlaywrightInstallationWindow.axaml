<Window
    x:Class="Haihv.Vbdlis.Tools.Desktop.Views.PlaywrightInstallationWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:Haihv.Vbdlis.Tools.Desktop.ViewModels"
    Title="CÃ i Ä‘áº·t Playwright"
    Width="550"
    Height="320"
    d:DesignHeight="320"
    d:DesignWidth="550"
    x:DataType="vm:PlaywrightInstallationViewModel"
    CanResize="False"
    Icon="/Assets/appicon.png"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <Design.DataContext>
        <vm:PlaywrightInstallationViewModel />
    </Design.DataContext>

    <Border
        Padding="30"
        Background="{DynamicResource SystemAltHighColor}"
        CornerRadius="0">
        <StackPanel Spacing="20">

            <!--  Title  -->
            <TextBlock
                HorizontalAlignment="Center"
                FontSize="20"
                FontWeight="SemiBold"
                Text="CÃ i Ä‘áº·t Playwright" />

            <!--  Operating System Info  -->
            <TextBlock
                HorizontalAlignment="Center"
                Foreground="Gray"
                IsVisible="{Binding OperatingSystem, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                Text="{Binding OperatingSystem, StringFormat='Há»‡ Ä‘iá»u hÃ nh: {0}'}" />

            <!--  Status Message  -->
            <TextBlock
                HorizontalAlignment="Center"
                Text="{Binding StatusMessage}"
                TextAlignment="Center"
                TextWrapping="Wrap" />

            <!--  Progress Bar  -->
            <StackPanel Spacing="8">
                <ProgressBar
                    Height="8"
                    IsIndeterminate="{Binding IsIndeterminate}"
                    Maximum="100"
                    Value="{Binding ProgressValue}" />

                <!--  Progress Percentage (only visible when not indeterminate)  -->
                <TextBlock
                    HorizontalAlignment="Center"
                    FontSize="12"
                    Foreground="Gray"
                    IsVisible="{Binding !IsIndeterminate}"
                    Text="{Binding ProgressValue, StringFormat='{}{0}%'}" />
            </StackPanel>

            <!--  Error Message (only visible when there's an error)  -->
            <StackPanel IsVisible="{Binding HasError}" Spacing="10">
                <Border
                    Padding="10"
                    Background="#FFFFE0E0"
                    BorderBrush="#FFFF6B6B"
                    BorderThickness="1"
                    CornerRadius="4">
                    <StackPanel Spacing="5">
                        <TextBlock
                            FontWeight="SemiBold"
                            Foreground="#FFD32F2F"
                            Text="Lá»—i:" />
                        <TextBlock
                            Foreground="#FFD32F2F"
                            Text="{Binding ErrorMessage}"
                            TextWrapping="Wrap" />
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="11"
                            Foreground="#FF757575"
                            Text="á»¨ng dá»¥ng cáº§n Playwright Ä‘á»ƒ hoáº¡t Ä‘á»™ng. Vui lÃ²ng thá»­ láº¡i hoáº·c cÃ i Ä‘áº·t thá»§ cÃ´ng theo hÆ°á»›ng dáº«n trong file PLAYWRIGHT_SETUP.md"
                            TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!--  Action Buttons  -->
                <StackPanel
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="10">
                    <Button
                        Padding="15,8"
                        Background="#FF2196F3"
                        Command="{Binding RetryCommand}"
                        Content="ðŸ”„ Thá»­ láº¡i"
                        CornerRadius="4"
                        Foreground="White" />
                    <Button
                        Padding="15,8"
                        Background="#FFF44336"
                        Command="{Binding ExitCommand}"
                        Content="âŒ ÄÃ³ng á»©ng dá»¥ng"
                        CornerRadius="4"
                        Foreground="White" />
                </StackPanel>
            </StackPanel>

            <!--  Success Message (only visible when completed)  -->
            <Border
                Padding="10"
                Background="#FFE8F5E9"
                BorderBrush="#FF4CAF50"
                BorderThickness="1"
                CornerRadius="4"
                IsVisible="{Binding IsCompleted}">
                <StackPanel Spacing="5">
                    <TextBlock
                        HorizontalAlignment="Center"
                        FontWeight="SemiBold"
                        Foreground="#FF2E7D32"
                        Text="âœ“ HoÃ n táº¥t!" />
                    <TextBlock
                        HorizontalAlignment="Center"
                        FontSize="11"
                        Foreground="Gray"
                        Text="Cá»­a sá»• nÃ y sáº½ tá»± Ä‘á»™ng Ä‘Ã³ng sau vÃ i giÃ¢y..."
                        TextWrapping="Wrap" />
                </StackPanel>
            </Border>

        </StackPanel>
    </Border>

</Window>
